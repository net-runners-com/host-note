# HostNote 要件定義書

## 1. 目的の明確化

### 1.1 目的
ホストクラブで働くキャストが、お客様（姫）の情報、接客履歴、スケジュールを効率的に管理し、より良い接客を提供するためのモバイルアプリケーションを開発する。

### 1.2 対象ユーザー
- **プライマリユーザー**: ホストクラブのキャスト（ホスト）
- **対象環境**: 仕事中にスマートフォンで使用

### 1.3 解決する課題
- お客様の好みや特徴を覚えきれない
- 過去の接客内容を忘れてしまう
- 来店予定や誕生日を見逃してしまう
- メモが散在して管理が大変
- 他のキャストとの情報共有が難しい

### 1.4 期待される効果
- お客様一人ひとりに合わせた質の高い接客
- リピーター獲得率の向上
- 業務効率化による時間の有効活用
- チームワークの向上（ヘルプ履歴の記録）

---

## 2. 現状分析

### 2.1 市場の課題
- 既存のCRMアプリは機能が多すぎて使いづらい
- 接客業特化のアプリが少ない
- データをクラウドに保存することへの抵抗感
- 仕事中に素早く入力できるUIが求められる

### 2.2 競合分析
| アプリ | 特徴 | 課題 |
|--------|------|------|
| 一般的なメモアプリ | シンプル | 顧客管理に特化していない |
| 汎用CRMアプリ | 高機能 | 複雑で使いづらい、有料 |
| Excelスプレッドシート | 柔軟 | スマホで使いにくい |

### 2.3 差別化ポイント
- ✅ **接客業に特化**: 姫・キャスト・卓記録の管理
- ✅ **シンプルなUI**: 仕事中に素早く操作できる
- ✅ **ローカル保存**: プライバシー重視、オフライン動作
- ✅ **通知機能**: 来店予定・誕生日を忘れない
- ✅ **カスタマイズ可能**: 5種類のテーマ

---

## 3. 機能要件

### 3.1 必須機能（Phase 1: MVP）

#### F-001: 姫（お客様）管理
- **優先度**: P0 (Critical)
- **説明**: お客様の情報を登録・編集・削除・閲覧する
- **詳細要件**:
  - 名前（必須）
  - 写真（任意、ない場合は自動生成アバター）
  - SNS情報（Twitter, Instagram, LINE等）
  - 誕生日
  - 初回フラグ（初回 or リピーター）
  - 担当キャスト
  - お酒の好み（自由記述）
  - 割物の好み（自由記述）
  - メモ（自由記述）
- **受け入れ基準**:
  - [ ] 姫の新規登録ができる
  - [ ] 姫の一覧表示ができる
  - [ ] 姫の詳細表示ができる
  - [ ] 姫の情報編集ができる
  - [ ] 姫の削除ができる（確認ダイアログ付き）
  - [ ] 来店履歴が表示される

---

#### F-002: キャスト管理
- **優先度**: P0 (Critical)
- **説明**: 働いているキャストの情報を登録・編集・削除・閲覧する
- **詳細要件**:
  - 名前（必須）
  - 写真（任意、ない場合は自動生成アバター）
  - SNS情報
  - 誕生日
  - メモ（得意なトークテーマ、特徴など）
- **受け入れ基準**:
  - [ ] キャストの新規登録ができる
  - [ ] キャストの一覧表示ができる
  - [ ] キャストの詳細表示ができる
  - [ ] キャストの情報編集ができる
  - [ ] キャストの削除ができる
  - [ ] 担当している姫のリストが表示される

---

#### F-003: 卓記録管理
- **優先度**: P0 (Critical)
- **説明**: 接客した卓（テーブル）の記録を作成・編集・削除・閲覧する
- **詳細要件**:
  - 日時（必須、デフォルト：現在時刻）
  - 卓番号（任意）
  - 参加した姫（複数選択可）
  - メインキャスト（1名選択）
  - ヘルプキャスト（複数選択可）
  - メモ（会話内容、出来事など）
- **受け入れ基準**:
  - [ ] 卓記録の新規作成ができる
  - [ ] 卓記録の一覧表示ができる
  - [ ] 卓記録の詳細表示ができる
  - [ ] 卓記録の編集ができる
  - [ ] 卓記録の削除ができる
  - [ ] 姫ごとの卓記録履歴が表示される

---

#### F-004: ホーム画面（ダッシュボード）
- **優先度**: P0 (Critical)
- **説明**: 今日の予定や直近の情報を一目で確認できる画面
- **詳細要件**:
  - 今日の来店予定リスト
  - 直近の卓記録（5件）
  - 今月の誕生日リスト（姫・キャスト）
- **受け入れ基準**:
  - [ ] 今日の来店予定が表示される
  - [ ] 直近5件の卓記録が表示される
  - [ ] 今月の誕生日が表示される
  - [ ] 各項目から詳細画面に遷移できる
  - [ ] 空状態が適切に表示される

---

#### F-005: タブナビゲーション
- **優先度**: P0 (Critical)
- **説明**: 各機能に素早くアクセスできるボトムタブ
- **詳細要件**:
  - ホーム
  - 姫一覧
  - キャスト一覧
  - 卓記録一覧
  - カレンダー
- **受け入れ基準**:
  - [ ] 5つのタブが表示される
  - [ ] タブ切り替えがスムーズに動作する
  - [ ] 選択中のタブがハイライトされる
  - [ ] 各タブにアイコンとラベルが表示される

---

### 3.2 基本機能（Phase 1）

#### F-006: カレンダー表示
- **優先度**: P1 (High)
- **説明**: 来店履歴・予定を視覚的に確認できるカレンダー
- **詳細要件**:
  - 月表示
  - 週表示
  - 日表示
  - 卓記録のある日にマーカー表示
  - 誕生日にマーカー表示
  - 来店予定にマーカー表示
- **受け入れ基準**:
  - [ ] 月/週/日の表示切り替えができる
  - [ ] 卓記録のある日が視覚的に分かる
  - [ ] 誕生日が視覚的に分かる
  - [ ] 日付をタップすると詳細が表示される

---

#### F-007: 来店予定管理
- **優先度**: P1 (High)
- **説明**: 姫の来店予定を登録・管理する
- **詳細要件**:
  - 姫の選択
  - 予定日時
  - メモ
  - 通知設定
- **受け入れ基準**:
  - [ ] 来店予定の新規登録ができる
  - [ ] 来店予定の編集・削除ができる
  - [ ] カレンダーに予定が表示される
  - [ ] ホーム画面に今日の予定が表示される

---

#### F-008: 検索機能
- **優先度**: P1 (High)
- **説明**: 姫・キャストを名前で検索する
- **詳細要件**:
  - リアルタイム検索（デバウンス処理）
  - 部分一致検索
  - 検索結果の一覧表示
- **受け入れ基準**:
  - [ ] 検索バーが表示される
  - [ ] 入力中にリアルタイムで絞り込まれる
  - [ ] 検索結果が適切に表示される
  - [ ] 検索結果0件時のメッセージが表示される

---

#### F-009: プッシュ通知
- **優先度**: P1 (High)
- **説明**: 来店予定や誕生日の通知を受け取る
- **詳細要件**:
  - 来店予定の通知（設定可能な時間前）
  - 誕生日の通知（設定可能な日数前）
  - 通知タップでアプリを開く
- **受け入れ基準**:
  - [ ] 通知権限のリクエストができる
  - [ ] 来店予定の通知が届く
  - [ ] 誕生日の通知が届く
  - [ ] 通知時間を設定できる
  - [ ] 通知をタップすると該当画面が開く

---

#### F-010: テーマ切り替え
- **優先度**: P1 (High)
- **説明**: 見た目のカスタマイズができる
- **詳細要件**:
  - Lokatオリジナル（黒+ゴールド）
  - ダークモード
  - ライトモード
  - ミッドナイト
  - シャンパン
- **受け入れ基準**:
  - [ ] 5種類のテーマが選択できる
  - [ ] テーマ変更が即座に反映される
  - [ ] 選択したテーマが保存される
  - [ ] アプリ全体に適用される

---

#### F-011: 設定画面
- **優先度**: P1 (High)
- **説明**: アプリの各種設定を変更する
- **詳細要件**:
  - テーマ選択
  - 来店予定通知の時間設定
  - 誕生日通知の日数設定
  - アプリ情報表示
- **受け入れ基準**:
  - [ ] 設定画面が表示される
  - [ ] 各設定が変更できる
  - [ ] 設定が保存される
  - [ ] バージョン情報が表示される

---

### 3.3 改善機能（Phase 2）

#### F-012: 写真管理
- **優先度**: P2 (Medium)
- **説明**: 姫・キャストの写真を撮影・選択する
- **詳細要件**:
  - カメラで撮影
  - ギャラリーから選択
  - 写真の表示
  - 写真の削除
- **受け入れ基準**:
  - [ ] カメラで撮影できる
  - [ ] ギャラリーから選択できる
  - [ ] 選択した写真が表示される
  - [ ] 写真がローカルに保存される

---

#### F-013: アバター自動生成
- **優先度**: P2 (Medium)
- **説明**: 写真がない場合に自動でアバターを生成する
- **詳細要件**:
  - 名前を元にアバター生成
  - 複数のスタイルから選択
  - アバターの表示
- **受け入れ基準**:
  - [ ] 写真がない場合にアバターが生成される
  - [ ] アバターが適切に表示される
  - [ ] 名前が変わると新しいアバターが生成される

---

#### F-014: データバックアップ・復元
- **優先度**: P2 (Medium)
- **説明**: データをエクスポート・インポートする
- **詳細要件**:
  - JSON形式でエクスポート
  - ファイル共有
  - JSON形式でインポート
  - データの上書き・マージ選択
- **受け入れ基準**:
  - [ ] データをエクスポートできる
  - [ ] エクスポートしたファイルを共有できる
  - [ ] データをインポートできる
  - [ ] インポート前に確認ダイアログが表示される

---

#### F-015: 全データ削除
- **優先度**: P2 (Medium)
- **説明**: アプリをリセットする
- **詳細要件**:
  - 二重確認ダイアログ
  - 全データの削除
  - 初期状態への復元
- **受け入れ基準**:
  - [ ] 削除前に二重確認がある
  - [ ] 全データが削除される
  - [ ] 初期設定が再作成される

---

### 3.4 対象外機能（将来的に検討）

以下の機能は現バージョンでは実装しない:
- ❌ クラウド同期（データはローカルのみ）
- ❌ 複数端末間のデータ共有
- ❌ 売上管理機能
- ❌ 統計・分析ダッシュボード
- ❌ チーム機能（複数ユーザー）
- ❌ 音声メモ・ボイスレコーディング
- ❌ 位置情報連携
- ❌ SNS自動投稿

---

## 4. 非機能要件

### 4.1 パフォーマンス

#### NFR-001: アプリ起動時間
- **要件**: アプリ起動から使用可能になるまで3秒以内
- **測定方法**: 実機での起動時間測定
- **優先度**: High

#### NFR-002: 画面遷移速度
- **要件**: 画面遷移が0.5秒以内
- **測定方法**: 実機での遷移時間測定
- **優先度**: High

#### NFR-003: リスト表示パフォーマンス
- **要件**: 100件のデータでもスムーズにスクロール
- **測定方法**: FlatListのパフォーマンス測定
- **優先度**: Medium

#### NFR-004: データベースクエリ速度
- **要件**: 検索結果が1秒以内に表示される
- **測定方法**: クエリ実行時間測定
- **優先度**: Medium

---

### 4.2 可用性

#### NFR-005: オフライン動作
- **要件**: インターネット接続なしで全機能が使用可能
- **理由**: ローカルストレージのみ使用
- **優先度**: Critical

#### NFR-006: クラッシュ率
- **要件**: クラッシュ率1%未満
- **測定方法**: ユーザーからのフィードバック
- **優先度**: High

#### NFR-007: データ損失防止
- **要件**: 予期しない終了でもデータが失われない
- **実装**: トランザクション処理、定期自動保存
- **優先度**: Critical

---

### 4.3 ユーザビリティ

#### NFR-008: 直感的なUI
- **要件**: 初回使用でも迷わず操作できる
- **評価**: ユーザーテスト実施
- **優先度**: High

#### NFR-009: タップターゲットサイズ
- **要件**: タップ可能な要素は最低44x44pt
- **理由**: iOSヒューマンインターフェイスガイドライン準拠
- **優先度**: Medium

#### NFR-010: エラーメッセージの分かりやすさ
- **要件**: エラー時に具体的な対処法を提示
- **実装**: 適切なトーストメッセージ、ダイアログ
- **優先度**: Medium

#### NFR-011: 入力の簡便性
- **要件**: 必須項目は最小限に抑える
- **実装**: 名前以外は任意入力
- **優先度**: High

---

### 4.4 セキュリティ

#### NFR-012: データの暗号化
- **要件**: 機密性の高いデータは暗号化保存
- **実装**: 端末ロックによる保護、必要に応じてexpo-secure-store使用
- **優先度**: Medium

#### NFR-013: SQLインジェクション対策
- **要件**: プレースホルダー使用必須
- **実装**: 全てのクエリでプレースホルダー使用
- **優先度**: Critical

#### NFR-014: 入力値検証
- **要件**: 全ての入力値をバリデーション
- **実装**: フォームバリデーション、型チェック
- **優先度**: High

---

### 4.5 保守性

#### NFR-015: コードの可読性
- **要件**: TypeScript strict mode使用
- **実装**: ESLint + Prettier設定
- **優先度**: High

#### NFR-016: コンポーネントの再利用性
- **要件**: 共通コンポーネントの適切な抽象化
- **実装**: src/components/common/
- **優先度**: Medium

#### NFR-017: ドキュメント
- **要件**: 主要関数にコメント記載
- **実装**: JSDoc形式のコメント
- **優先度**: Low

---

### 4.6 拡張性

#### NFR-018: データベースマイグレーション
- **要件**: スキーマ変更に対応できる仕組み
- **実装**: マイグレーション機能
- **優先度**: High

#### NFR-019: 機能追加の容易性
- **要件**: 新機能追加が既存機能に影響しない
- **実装**: モジュール化、疎結合な設計
- **優先度**: Medium

---

### 4.7 互換性

#### NFR-020: iOS対応
- **要件**: iOS 13.0以上で動作
- **テスト**: iPhone 8以降の実機テスト
- **優先度**: Critical

#### NFR-021: Android対応
- **要件**: Android 5.0 (API 21)以上で動作
- **テスト**: 複数のAndroid端末でテスト
- **優先度**: Critical

#### NFR-022: 画面サイズ対応
- **要件**: 様々な画面サイズで適切に表示
- **実装**: レスポンシブデザイン
- **優先度**: High

---

### 4.8 ライセンス・法的要件

#### NFR-023: オープンソースライセンス遵守
- **要件**: 使用ライブラリのライセンス確認
- **実装**: MIT、Apache 2.0等の許可的ライセンスのみ使用
- **優先度**: Critical

#### NFR-024: プライバシーポリシー
- **要件**: データ収集なし（ローカル保存のみ）
- **実装**: プライバシーポリシー不要
- **優先度**: Low

---

## 5. 技術的制約条件

### 5.1 開発環境
- **言語**: TypeScript 5.x
- **フレームワーク**: React Native (Expo SDK 51+)
- **状態管理**: Zustand
- **データベース**: SQLite (expo-sqlite)
- **ビルドツール**: Expo CLI

### 5.2 ランタイム環境
- **iOS**: iOS 13.0以上
- **Android**: Android 5.0 (API 21)以上
- **ストレージ**: 最低50MB空き容量

### 5.3 外部依存関係
| ライブラリ | バージョン | 用途 |
|-----------|----------|------|
| expo-router | latest | ルーティング |
| expo-sqlite | latest | データベース |
| expo-notifications | latest | プッシュ通知 |
| expo-image-picker | latest | 写真選択 |
| react-native-calendars | latest | カレンダー表示 |
| @dicebear/core | latest | アバター生成 |
| zustand | latest | 状態管理 |
| date-fns | latest | 日付操作 |

---

## 6. 成果物

### 6.1 開発成果物
- [ ] React Native (Expo) アプリケーション
- [ ] ソースコード（TypeScript）
- [ ] 設計書
- [ ] 実装計画書
- [ ] 要件定義書（本ドキュメント）

### 6.2 リリース成果物
- [ ] iOS用アプリ（.ipa）
- [ ] Android用アプリ（.apk / .aab）
- [ ] README.md
- [ ] CHANGELOG.md

---

## 7. 制約事項

### 7.1 技術的制約
- Expo Goの制限により、ネイティブモジュールの追加は不可
- 必要に応じてEAS Buildへの移行が必要
- SQLiteのデータベースサイズ上限に注意

### 7.2 スコープ制約
- Phase 1（6週間）でMVP完成を目指す
- Phase 2-3は予算・時間に応じて調整
- クラウド同期は対象外

### 7.3 リソース制約
- 開発者: 1名
- 開発期間: 10週間（MVP: 6週間）
- 予算: 無償ツールのみ使用

---

## 8. リスク管理

### 8.1 技術的リスク
| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| Expo Goの制限 | 中 | 低 | EAS Buildへの移行準備 |
| SQLite容量制限 | 低 | 低 | データクリーンアップ機能 |
| 通知が届かない | 中 | 中 | 権限チェック強化、テスト |
| 端末依存のバグ | 中 | 中 | 複数端末でのテスト |

### 8.2 プロジェクトリスク
| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 開発期間の延長 | 中 | 中 | スコープ調整、優先順位明確化 |
| 要件変更 | 低 | 低 | アジャイル開発で柔軟に対応 |
| ユーザーからの要望 | 低 | 高 | Phase 2-3で対応 |

---

## 9. 承認基準

### 9.1 MVP完成基準
- [ ] 全ての優先度P0（Critical）機能が実装済み
- [ ] 全ての優先度P1（High）機能が実装済み
- [ ] iOS/Android両方で動作確認済み
- [ ] 致命的なバグなし
- [ ] ユーザーテスト完了

### 9.2 Phase 2完成基準
- [ ] 全ての優先度P2（Medium）機能が実装済み
- [ ] パフォーマンス要件を満たす
- [ ] ドキュメント整備済み

### 9.3 リリース基準
- [ ] 全機能が正常動作
- [ ] アイコン・スプラッシュ画像設定済み
- [ ] ビルド成功
- [ ] ストア申請資料準備済み（必要な場合）

---

## 10. 次のアクション

### 10.1 開発開始前
1. ✅ 設計書作成（完了）
2. ✅ 実装計画書作成（完了）
3. ✅ 要件定義書作成（完了）
4. ⬜ 開発環境セットアップ

### 10.2 Sprint 1（第1週）
1. ⬜ Expoプロジェクト初期化
2. ⬜ ディレクトリ構造作成
3. ⬜ データベーススキーマ実装
4. ⬜ リポジトリパターン実装
5. ⬜ タブナビゲーション実装

### 10.3 Sprint 2以降
- 実装計画書のユーザーストーリーに沿って順次実装

---

## 11. 付録

### 11.1 用語集
| 用語 | 説明 |
|------|------|
| 姫 | ホストクラブのお客様（女性客）を指す業界用語 |
| キャスト | ホストクラブで働くスタッフ（ホスト） |
| 卓 | テーブル、接客の単位 |
| メイン | メインで接客を担当するキャスト |
| ヘルプ | サポートで入るキャスト |
| 担当 | 特定の姫を主に接客するキャスト |
| 割物 | お酒を割るもの（水、炭酸水など） |

### 11.2 参考資料
- Expo公式ドキュメント: https://docs.expo.dev/
- React Native公式ドキュメント: https://reactnative.dev/
- TypeScript公式ドキュメント: https://www.typescriptlang.org/
- SQLite公式ドキュメント: https://www.sqlite.org/

### 11.3 変更履歴
| バージョン | 日付 | 変更内容 | 作成者 |
|-----------|------|----------|--------|
| 1.0.0 | 2024-11-10 | 初版作成 | Claude |

---

## まとめ

この要件定義書は、HostNoteアプリの開発における全ての要件を網羅しています。

**重要なポイント:**
- ✅ 目的・対象ユーザーが明確
- ✅ 機能要件が優先度別に整理されている
- ✅ 非機能要件が具体的に定義されている
- ✅ 制約事項とリスクが明確化されている
- ✅ 承認基準が設定されている

この3つのドキュメント（設計書、実装計画書、要件定義書）を元に、Cursorでの開発を開始できます！
